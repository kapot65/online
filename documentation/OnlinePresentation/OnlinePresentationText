1. Тема презентации - Модернизация системы сбора данных на установке Троицк ню масс.

2. Установка Троицк ню масс работет с 19хх года, предназанчена для набора спектров для прямого измерения массы нейтрино. Установка состоит из интегрального электростатического спектрометра с магнитной адиабатической коллимацией, безоконного источника электронов с молекулярным тритием в газообразном состоянии, вакуумной системы откачки, криогенной системы для обеспечения работы сверхпроводящих соленоидов спектрометра и источника, высоковольтной системы.

Для набора спектра, необходимо пошагово увеличивая напряжение задерживающего потенциала, проводить набор событий.

3. С 19хх года на установке появилась система сбора данных, написанная Задорожным С. В., позволяющая проводить автоматизированный набор спектров.
Комплекс написан на языке Pascal, работет на машине dell.

--схема сбора

По интерфейсу -- система управляет высоким напряжением. Считывание напряжения осуществляется через возьтметры Aligent , Контроль осуществляется через АЦП
Управление детекторной частью осущевствляется через крейт Camac.

4.
-- картинка с Camac и схематическим детектором

Сигнал с детектора порождает строб, который воспринимается блоком MADC.

Т.о. счет событий осуществяется аппаратно, что позволяет добится высокой скорости счета (какой?)

6. Однако комплекс использует функции ос dos, и устаревшие аппаратные интерфейсы, что намертво привязывает ее к определенному программному и аппаратному обеспечению.
В связи с общей модернизацией системы хранения данных было решено модернизировать и систему набора.

7. Новая система сбора данных также основана на двух крейт контроллерах CAMAC CCPC7. Контроллер крейта CAMAC CCPC7 со встроенным IBM PC конструктивно представляет собой модуль CAMAC шириной 2М, на лицевую панель которого выведены разъемы синхронизации и подключения внешних устройств PC. В контроллер установлена система ubuntu со вшитыми драйверами управления Camac.

Контроллеры позволяют локализовать использование аппаратных интерфейсов.

9. Алгоритм набора остался старым. Изменилась только локализация действий по модулям.

-- Схема системы, Алгоритм набора.

 1. OnlineClient - отвечает за проведение сценария, взаимодействие с пользователем, общение с б.д. (будущее).
 2. CounterServer - Отвечает за котроль крейта детектора. Предоставяет функцию набора точки по времени. Также, частично исполняет роль резервного хранения последних набранных данных.
 3. HVSever - Предоставляет функции, связанные с установкой и контролем высокого напряжения.
 4. DataVisualizer - Задуман, как быстрый визуализатор набранных данных.

10. Связь между модулями системы осуществляется через интерфейс TCP/IP,таким образом, для связи модулей достаточно только их подключения к ethernet.

В качестве протокола используется Dataforge-envelope, предложенный Нозиком А.А.. 

--Пример пакета.

В этом протоколе пакет делится на 3 части.

 -Бинарный заголовок -  содержит информацию о версии пакета, метаданных и бианрных данных.
 -Метаданые - в формате json, xml, или обговоренным другом.
 -Бинарные данные - Формат бинарных данных может быть описан либо в метаданных, либо в бинарном заголовке,
 либо и там и там.

Протокол расширяем, поддерживает вложенность и универсален по хранению данных.

Недостатком явяется сложность в ручном создании пакета из-за бинарного хедера. (Однако для таких целей возможно обговорить специальную версию бинарного хедера)

11. Хранение данных также осуществяется в формате Dataforge-envelope. Бд иерархическая (в формате вложенных папок).
Данные содержат
 - Данные о набраных событиях для каждой точки
 - Метаданные, содержащие информацию о пользоваетеле и комментарии к набору.
 - Картину напряжений на время сбора.
 
Пока что бд представляет из себя вложенные папки на локальной машине. В будущем бд будет лежать на сервере, но иметь такую же структуру.

Выбор такой структуры обуслевлен простотой поиска по ней вречную.

В бд наборы разделяются по:
 - Названию эксперимента (раз в полгода)
 - Названию группы в рамкаж эксперимента
 - Итерации

12.
 Система тестировалась на тестовом генераторе.
 Планируется протестировать ситему набора на рельном эксперименте.
 
 Также, в будущем планируется интеграция системы в общую систему управления экспериментом Троицк ню масс. (Помимо котроля напряжения задерживающего потенциала и счета точек, на установке есть контроль температуры магнитов, давления, спектра источника).

