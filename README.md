# Программный комплекс Online
## Введение
Программный комплекс Online предназначен для набора данных на установке Троицк ню масс. Комплекс написан на Qt 5.4 (4.8 для CCPC7_Server)
с использованием сторонних библиотек [QJson](http://qjson.sourceforge.net/), [QCustomPlot](http://www.qcustomplot.com/)
и [easylogging++](https://github.com/easylogging/easyloggingpp). Комплекс состоит из 4 программ.

- **CamacClient** - Основная программа, через нее проводится управление сбором. Программа подключается к CCPC7_Server и HV_Server и с помощью них проводит управление набором. CamacClient общается с CCPC7_Server и HV_Server по средствам TCP в формате http://elog.mass.inr.ru/online/1. Программа позволяет:
     - Установить сценарий сбора.
     - Провести одно или несколько повторений сбора по сценарию со сменой или без смены направления прохода.
     - Провести предварительную визуализацию собираемых данных.
     - Выводить текущую информацию о сборе.
     - Контролировать процесс сбора (ставить на паузу, останавливать сбор. Делать текущее повторение последним).

 На данный момент используется только **CamacClient**. Варианты других модулей:
 Модули детектора:

## Сборка проекта
**CamacClient** собирается стандартными средствами Qt и не имеет сторонних зависимостей.

### Сборка документации
```shell
# установка необходимых пакетов
sudo apt install graphviz
sudo apt install doxygen

cd documentation

./make_graphs.sh # отрисовка графов
doxygen
```

## Разработка модулей
Система может работать в полностью виртуальном режиме. Для этого надо:
- использовать [hv-server-precise](https://github.com/kapot65/hv-server-precise) в [виртуальном режиме](https://github.com/kapot65/hv-server-precise/blob/master/config.py#L8) в качестве модуля высоковольтной стойки.
- Использовать [keysight-6430-reader](https://github.com/kapot65/keysight-reader) в виртуальном режиме в качестве модуля детектора.
  
  ```shell
  RUST_LOG=info cargo run --release --bin keithley-6430-reader --features virtual
  ```

Для удобства, можно поочередно заменять виртуальные модули разрабатываемыми.